# Service_cash
Service cash представляет собой тестовое задание, написанное на Python 2.7.13 с использованием синхронного фреймворка Pyramid.

Web-сервис на Python (Pyramid, версия Python 2.7.13).
Для того, чтобы запустить проект необходимо:

    1) Создать виртуальное окружение и активировать его 
    2) Выполнить в виртуальном окружении python2 setup.py develop
    3) И запустить сервер: pserve development.ini
 
**База данных**
В рамках разработки сервиса, была спроектирована база данных. Она позволяет хранить данные о счетах,
и данные по операциям. Она позволяет получить:
    1) Информацию о Доноре (Сумму, которой располагал счёт на момент перевода денег, актульную сумму денег, валюту счёта)
    2) Информацию о Реципиенте (Сумму, которой располагал счёт на момент перевода денег, актульную сумму денег, валюту счёта)
    3) Информацию о операции (Время и сумму перевода)
    
![База данных](https://github.com/Gor-alex/cash_service/blob/master/backup/cash_schema.png)

Схема базы и файл бекапа, лежат в корне проекта. Конфигурация для подключения задаётся  в файлах конфигураций 
(development.ini, production.ini):

    ###
    # Postgresql configuration
    ###
    postgre_server = localhost
    bd_name = cash
    bd_port = 5432
    bd_user = postgres
    bd_password = 11111111


**Задание констант (Валюта)**

Иформация о курсах валют являются константами:
1 EUR   = 1,24 USD
1 EUR = 70,53 RUB
1 USD = 56,80 RUB

В проекте информация задаётся в файлах конфигурации (development.ini, production.ini) в виде коэффициентов::

    ###
    # Сurrency
    ###
    EUR_to_USD = 1.24
    EUR_to_RUB = 70.53
    USD_to_RUB = 56.80


И создан web-сервис принимающий запросы по протоколу HTTP. Сервис предоставляет 3 метода по управлению счетами:

**1. Создание нового счёта**
Для создания нового счёта необходимо отправить POST запрос на http://url_service/account ,
Для прохождения базовой валидации, в заголовке запроса необходимо указать "Content-Type: application/json"
Пример и расшифровка Json: 

    {
        "actual_bill": 123.223, # Сумма с которой открывается счёт
        "overdraft": false, # Возможность или невозмодность овердрафта
        "currency": "RUB" # Валюта счёта (Все поддерживаемые валюты, описаны в таблице-классификаторе currency)
    }
Возвращаемое значение: id созданного счёта

**2. Перевод валюты со счета А на счет Б**
Для перевода валюты с одного счёта на другой необходимо отправить POST запрос на http://url_service/transfer ,
Для прохождения базовой валидации, в заголовке запроса необходимо указать "Content-Type: application/json".
Сделано допущение, что донор всегда переводит тот вид валюты, который указан у него в аккаунте, как базовый. 
Пример и расшифровка Json:

    {
        "donor": 2, # id индификатор счёта "Донора"
        "recipient": 3, # id индификатор счёта "Реципиента"
        "delta": 123.223 # Сумма операции
    
    }

Возвращаемое значение: False/True (Успешность операции)

**3. Запрос баланса счета**
Для запроса баланса счёта необходимо отправить GET запрос на http://url_service/account ,
указав как параметр id=(Уникальный номер счёта)
Пример:
    http://url_service/account?id=4

Возвращаемое значение - Json вида: 

    {
        "currency": {
            "sname": "RUB",
            "fname": "Российский рубль"
        },
        "actualbill": "123.223"
    }

